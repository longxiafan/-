# 需求文档

## 简介

海洋垃圾检测系统是一个基于Web的应用程序，允许用户上传海洋垃圾图片并获得自动分类结果和置信度分数。系统使用机器学习（YOLOv8）来识别不同类型的海洋垃圾，帮助环境监测和清理工作。

## 需求

### 需求 1

**用户故事：** 作为环境研究人员，我希望上传海洋垃圾照片，以便快速识别和分类海洋垃圾进行数据收集。

#### 验收标准

1. 当用户访问应用程序时，系统应显示文件上传界面
2. 当用户选择图片文件时，系统应验证文件是否为支持的图片格式（JPG、PNG、JPEG）
3. 当用户上传有效图片时，系统应在处理过程中显示进度指示器
4. 当图片处理完成时，系统应显示检测到的垃圾类别和置信度分数

### 需求 2

**用户故事：** 作为公民科学家，我希望看到清晰的垃圾检测结果，以便了解我上传的照片中存在哪些类型的垃圾。

#### 验收标准

1. 当AI模型处理图片时，系统应返回所有置信度分数高于最小阈值的检测对象
2. 当显示结果时，系统应以用户友好的格式显示垃圾类别名称
3. 当显示结果时，系统应显示四舍五入到适当小数位的置信度百分比
4. 当未检测到垃圾时，系统应显示适当的消息，表明未发现垃圾

### 需求 3

**用户故事：** 作为系统管理员，我希望应用程序能够优雅地处理错误，以便用户即使在出现问题时也能有流畅的体验。

#### 验收标准

1. 当上传无效文件格式时，系统应显示清晰的错误消息
2. 当AI模型无法处理图片时，系统应返回适当的错误响应
3. 当后端服务不可用时，前端应显示服务不可用消息
4. 当文件大小超过限制时，系统应拒绝上传并显示描述性错误消息

### 需求 4

**用户故事：** 作为开发人员，我希望系统有一个Python FastAPI后端和清晰的API接口，以便处理图片并返回分类结果。

#### 验收标准

1. 当API接收到对`/api/predict`的POST请求时，应使用Python FastAPI接受包含图片文件的multipart/form-data
2. 当处理图片时，系统应调用`ai/inference.py`模块执行YOLOv8推理
3. 当处理成功时，API应返回包含检测到的垃圾类别和置信度分数的JSON响应
4. 当FastAPI应用程序启动时，应使用训练好的模型权重初始化AI推理模块
5. 当推理过程中发生错误时，API应返回适当的HTTP状态码和错误描述

### 需求 5

**用户故事：** 作为用户，我希望有一个带有文件上传和可视化结果的Streamlit Web界面，以便轻松与海洋垃圾检测系统交互。

#### 验收标准

1. 当访问应用程序时，系统应在`app.py`中显示基于Streamlit的Web界面
2. 当上传图片时，界面应提供接受图片文件的文件上传控件
3. 当处理图片时，系统应显示进度条以显示处理状态
4. 当调用后端时，前端应向`/api/predict`端点发出POST请求
5. 当接收到结果时，系统应显示检测到的垃圾类别和置信度分数
6. 当显示置信度分数时，系统应将其显示为条形图以便清晰可视化

### 需求 6

**用户故事：** 作为研究人员，我希望系统能够存储检测历史记录，以便进行数据分析和统计。

#### 验收标准

1. 当检测完成时，系统应将检测结果保存到数据库中
2. 当保存记录时，系统应包含图片信息、检测结果、时间戳等数据
3. 当用户查询时，系统应能够检索历史检测记录
4. 当显示历史记录时，系统应提供分页和筛选功能
5. 当进行统计分析时，系统应能够按类别、时间等维度汇总数据

### 需求 7

**用户故事：** 作为用户，我希望应用程序具有可访问性和响应性，以便在不同设备上有效使用。

#### 验收标准

1. 当访问应用程序时，界面应具有响应性并在桌面和移动设备上工作
2. 当上传图片时，系统应提供关于上传状态的清晰视觉反馈
3. 当显示结果时，应以清晰、可读的方式格式化
4. 当使用应用程序时，所有交互元素应可通过键盘导航访问